//------------------------------------------------------------------------------
// <auto-generated>
//    This code was generated from a template.
//    Manual changes to this file may cause unexpected behavior in your application.
//    Manual changes to this file will be overwritten if the code is regenerated.
//	  Code duoc tao boi ADMIN-PC\CUONG luc 05:02:08 ngay 08/01/2014
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Collections;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Collections.Specialized;
using System.ComponentModel;
using System.Data.EntityClient;
using System.Data.Objects;
using System.Data.Objects.DataClasses;
using System.Runtime.Serialization;
using System.Xml.Serialization;
using System.Linq;
using PSC_ERP_Business.Main.Factory;
using PSC_ERP_Business.Main.Model;

namespace PSC_ERP_Business.Main.Predefined
{


    public partial class BoPhanMapping
    {
        public static List<BoPhanMapping> Get_DanhSachBoPhanMapping()
        {
            List<BoPhanMapping> list = new List<BoPhanMapping>();
            IQueryable<tblnsBoPhan> boPhanList = BoPhan_Factory.New().GetBoPhanbyMaCongTy(ERP_Library.Security.CurrentUser.Info.MaCongTy);
            IQueryable<tblnsBoPhanMoRong> boPhanMoRongList = BoPhanMoRong_Factory.New().GetAll();

            //Lấy từ bộ phận 
            foreach (tblnsBoPhan itemBoPhan in boPhanList)
            {
                BoPhanMapping boPhanMapping = new BoPhanMapping();
                boPhanMapping.MaBoPhan = itemBoPhan.MaBoPhan;
                boPhanMapping.TenBoPhan = itemBoPhan.TenBoPhan;
                boPhanMapping.MaBoPhanQL = itemBoPhan.MaBoPhanQL;
                boPhanMapping.MaBoPhanCha = itemBoPhan.MaBoPhanCha;

                //Thêm vào danh sách bộ phận mapping
                list.Add(boPhanMapping);
            }
            //Lấy từ bộ phận mở rộng
            foreach (tblnsBoPhanMoRong itemBoPhanMoRong in boPhanMoRongList)
            {
                BoPhanMapping boPhanMapping = new BoPhanMapping();
                boPhanMapping.MaBoPhan = itemBoPhanMoRong.MaBoPhanMoRong;
                boPhanMapping.TenBoPhan = itemBoPhanMoRong.TenBoPhanMoRong;
                boPhanMapping.MaBoPhanQL = itemBoPhanMoRong.MaQuanLy;
                boPhanMapping.MaBoPhanCha = itemBoPhanMoRong.MaBoPhanCha;
                boPhanMapping.LaBoPhanMoRong = true;

                //Thêm vào danh sách bộ phận mapping
                list.Add(boPhanMapping);
            }

            //Sắp xếp theo tên bộ phận
            list.Sort(delegate(BoPhanMapping x, BoPhanMapping y)
            {
                if (x.TenBoPhan == null && y.TenBoPhan == null) return 0;
                else if (x.TenBoPhan == null) return -1;
                else if (y.TenBoPhan == null) return 1;
                else return x.TenBoPhan.CompareTo(y.TenBoPhan);
            });
            return list;
        }
        public BoPhanMapping()
        {

        }

        public int MaBoPhan
        {
            get
            {
                return _maBoPhan;
            }
            set
            {
                _maBoPhan = value;

            }
        }
        private int _maBoPhan;


        public string TenBoPhan
        {
            get
            {
                return _tenBoPhan;
            }
            set
            {
                _tenBoPhan = value;

            }
        }

        private string _tenBoPhan;

        public string MaBoPhanQL
        {
            get
            {
                return _maBoPhanQL;
            }
            set
            {
                _maBoPhanQL = value;
            }
        }

        private string _maBoPhanQL;



        public Nullable<int> MaBoPhanCha
        {
            get
            {
                return _maBoPhanCha;
            }
            set
            {
                _maBoPhanCha = value;
            }
        }
        private Nullable<int> _maBoPhanCha;

        public Nullable<bool> LaBoPhanMoRong
        {
            get
            {
                return _laBoPhanMoRong;
            }
            set
            {

                _laBoPhanMoRong = value;

            }
        }
        private Nullable<bool> _laBoPhanMoRong;

       
    }
}
